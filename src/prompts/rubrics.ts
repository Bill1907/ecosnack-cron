/**
 * 중요도 점수 Rubric - AI 분석 일관성을 위한 명확한 기준
 *
 * 중요도 점수(1-10)의 의미와 기준을 정의하여
 * AI가 일관된 점수를 부여하도록 가이드
 */

// ============================================
// 중요도 점수 Rubric
// ============================================

export const IMPORTANCE_RUBRIC = `
## 중요도 점수 기준 (1-10)

뉴스의 중요도는 **영향 범위**와 **영향 강도**를 기준으로 평가합니다.

### 점수별 기준

| 점수 | 영향 범위 | 예시 |
|------|----------|------|
| **1-2** | 특정 기업/지역에 한정 | 소규모 기업 인사 발표, 지역 축제 뉴스 |
| **3-4** | 업계 일부에 영향 | 중견기업 실적, 업계 내 파트너십 발표 |
| **5-6** | 한 섹터 전체에 영향 | 산업 규제 변경, 주요 기업 전략 발표 |
| **7-8** | 여러 섹터/시장에 영향 | 대기업 실적, 무역 협정, 원자재 가격 변동 |
| **9-10** | 경제 전체/시스템적 영향 | 중앙은행 금리 결정, GDP/CPI 발표, 금융위기 조짐 |

### 앵커 포인트 (기준점)

- **10점**: 글로벌 금융위기, 팬데믹 선언, 주요국 디폴트
- **9점**: 연준/한은 금리 결정, 미중 무역협상 타결, 주요국 GDP 발표
- **8점**: 삼성전자/애플 분기 실적, 주요 M&A 발표, OPEC 감산 결정
- **7점**: 코스피 대장주 실적, 산업별 주요 정책 발표, 환율 급변
- **6점**: 업종 대표기업 실적, 섹터 규제 변화, 주요 IPO
- **5점**: 중견기업 실적, 업계 트렌드 분석, 신제품 출시
- **4점**: 개별 기업 전략 발표, 소규모 M&A, 업계 행사
- **3점**: 기업 인사 변동, 마이너 규제 변경
- **2점**: 지역 한정 뉴스, 개별 매장 소식
- **1점**: 홍보성 기사, 실질적 영향 없는 뉴스

### 점수 결정 시 고려사항

1. **시장 반응 예상**: 이 뉴스로 주가/금리/환율이 움직일 가능성은?
2. **영향 대상 규모**: 영향받는 투자자/기업/소비자 수는?
3. **시간적 지속성**: 단발성인가, 지속적 영향인가?
4. **정보의 신규성**: 예상된 내용인가, 서프라이즈인가?
`;

// ============================================
// 감성 분석 Rubric
// ============================================

export const SENTIMENT_RUBRIC = `
## 감성(Sentiment) 분석 기준

### 감성 분류

| 감성 | 정의 | 시장 영향 |
|------|------|----------|
| **positive** | 경제/시장에 긍정적 신호 | 주가 상승, 소비 증가, 고용 개선 기대 |
| **negative** | 경제/시장에 부정적 신호 | 주가 하락, 소비 위축, 불확실성 증가 |
| **neutral** | 뚜렷한 방향성 없음 | 정보 제공 목적, 시장 영향 제한적 |
| **mixed** | 긍정/부정 요소 혼재 | 해석에 따라 다른 반응 가능 |

### 신뢰도(Confidence) 기준

| 신뢰도 | 상황 |
|--------|------|
| **0.9-1.0** | 기사가 명확히 긍정/부정 표현 (예: "사상 최대 실적", "파산 신청") |
| **0.7-0.9** | 맥락상 방향성이 분명함 (예: 금리 인상 → 부정적) |
| **0.5-0.7** | 해석의 여지가 있음 (예: M&A → 시너지 vs 부채 증가) |
| **0.3-0.5** | 방향성이 불분명하거나 혼재 |
| **0.0-0.3** | 정보 부족으로 판단 어려움 |

### 주의사항

- 기사 톤이 아닌 **실제 경제적 영향**을 기준으로 판단
- 단기 vs 장기 영향이 다를 경우 **중기(1-3개월) 영향** 기준
- 주어진 정보만으로 판단, 외부 지식 과도하게 활용 지양
`;

// ============================================
// 카테고리 분류 Rubric
// ============================================

export const CATEGORY_RUBRIC = `
## 카테고리 분류 기준

| 카테고리 | 정의 | 예시 키워드 |
|----------|------|-------------|
| **economy** | 거시경제 지표, 경제 전망 | GDP, 인플레이션, 실업률, 경기, 성장률 |
| **finance** | 금융기관, 금리, 통화정책 | 은행, 금리, 연준, 한은, 대출, 예금 |
| **business** | 기업 활동, 실적, 경영 | 실적, 매출, 영업이익, CEO, M&A, 신제품 |
| **markets** | 주식/채권/원자재 시장 | 코스피, S&P500, 주가, 채권, 금값, 유가 |
| **policy** | 정부 정책, 규제 | 규제, 법안, 정책, 세금, 관세 |
| **trade** | 국제무역, 수출입 | 수출, 수입, 무역협정, 관세, 공급망 |

### 분류 우선순위

하나의 기사가 여러 카테고리에 해당할 경우:
1. **핵심 주제**가 무엇인지 파악
2. **시장 영향**의 주된 경로 고려
3. 애매한 경우 더 넓은 범위의 카테고리 선택

예시:
- "연준 금리 결정" → **policy** (통화정책이 핵심)
- "삼성전자 실적 발표" → **business** (기업 실적이 핵심)
- "코스피 2,500 돌파" → **markets** (시장 동향이 핵심)
`;

// ============================================
// 시간 지평(Time Horizon) Rubric
// ============================================

export const TIME_HORIZON_RUBRIC = `
## 시간 지평(Time Horizon) 기준

영향이 **가장 크게 나타나는 시점**을 기준으로 판단합니다.

| 구분 | 기간 | 예시 |
|------|------|------|
| **short** | 1주일 이내 | 실적 발표 직후 주가 반응, 금리 결정 당일 시장 반응 |
| **medium** | 1주~3개월 | 정책 효과 반영, 실적 가이던스 반영, 계절적 요인 |
| **long** | 3개월 이상 | 구조적 변화, 장기 트렌드, 인구/기후 변화 영향 |

### 판단 기준

1. **즉각 반응 vs 점진 반영**: 시장이 바로 반응하나, 시간 걸려 반영되나?
2. **일회성 vs 지속성**: 이벤트가 끝나면 영향도 끝나나, 지속되나?
3. **불확실성 해소 시점**: 언제 결과가 명확해지나?
`;

// ============================================
// 전체 Rubric 결합
// ============================================

export const FULL_ANALYSIS_RUBRIC = `
${IMPORTANCE_RUBRIC}

---

${SENTIMENT_RUBRIC}

---

${CATEGORY_RUBRIC}

---

${TIME_HORIZON_RUBRIC}
`;

/**
 * 특정 필드에 대한 Rubric만 반환
 */
export function getRubricForField(
  field: "importance" | "sentiment" | "category" | "timeHorizon"
): string {
  switch (field) {
    case "importance":
      return IMPORTANCE_RUBRIC;
    case "sentiment":
      return SENTIMENT_RUBRIC;
    case "category":
      return CATEGORY_RUBRIC;
    case "timeHorizon":
      return TIME_HORIZON_RUBRIC;
    default:
      return FULL_ANALYSIS_RUBRIC;
  }
}
