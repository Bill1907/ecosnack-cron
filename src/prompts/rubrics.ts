/**
 * 중요도 점수 Rubric - AI 분석 일관성을 위한 명확한 기준
 *
 * 중요도 점수(1-10)의 의미와 기준을 정의하여
 * AI가 일관된 점수를 부여하도록 가이드
 */

// ============================================
// 중요도 점수 Rubric
// ============================================

export const IMPORTANCE_RUBRIC = `
## 중요도 점수 기준 (1-10)

중요도 점수는 다음 4가지 요소의 합계로 산출합니다:

### 점수 계산 매트릭스

| 요소 | 점수 범위 | 기준 |
|------|----------|------|
| 영향범위 | 1-3점 | 영향받는 대상의 규모 |
| 영향강도 | 1-3점 | 변화의 크기/심각성 |
| 신규성 | 1-2점 | 예측 가능 여부 |
| 시간지속성 | 1-2점 | 영향 지속 기간 |

**총점 = 영향범위 + 영향강도 + 신규성 + 시간지속성 (최대 10점)**

---

### 1. 영향범위 (1-3점)

| 점수 | 기준 | 예시 |
|------|------|------|
| **1점** | 개별 기업/지역 한정 | 소규모 기업 인사, 지역 뉴스 |
| **2점** | 업종/섹터 영향 | 업종 규제, 대기업 실적 |
| **3점** | 경제 전체/시스템적 | 금리 결정, GDP 발표, 금융위기 |

---

### 2. 영향강도 (1-3점)

| 점수 | 기준 | 예시 |
|------|------|------|
| **1점** | 미미한 변화 | 소폭 변동, 예상 범위 내 |
| **2점** | 주목할 만한 변화 | 시장 조정, 정책 변화 |
| **3점** | 큰 변화/위기 | 급등락, 규제 개편, 위기 상황 |

---

### 3. 신규성 (1-2점)

| 점수 | 기준 | 예시 |
|------|------|------|
| **1점** | 예상된 내용 | 예측된 실적, 예고된 정책 |
| **2점** | 서프라이즈 | 예상 외 실적, 깜짝 발표 |

---

### 4. 시간지속성 (1-2점)

| 점수 | 기준 | 예시 |
|------|------|------|
| **1점** | 단기/일회성 | 단발성 이벤트, 즉각 반영 후 소멸 |
| **2점** | 장기/구조적 | 정책 변화, 트렌드, 시스템 변화 |

---

### 앵커 포인트 (기준점)

- **10점** (3+3+2+2): 글로벌 금융위기, 팬데믹 선언
- **9점** (3+3+2+1 또는 3+3+1+2): 연준 금리 결정, 주요국 GDP
- **8점** (3+2+2+1 또는 2+3+2+1): 삼성/애플 실적, 주요 M&A
- **7점** (2+2+2+1 또는 3+2+1+1): 업종 정책, 환율 급변
- **6점** (2+2+1+1 또는 2+1+2+1): 대기업 실적, IPO
- **5점** (2+1+1+1 또는 1+2+1+1): 중견기업 실적, 트렌드
- **4점** (1+2+1+0 또는 1+1+1+1): 개별 전략, 소규모 M&A
- **3점** (1+1+1+0): 인사 변동, 마이너 규제
- **2점** (1+1+0+0): 지역 한정, 개별 매장
- **1점** (1+0+0+0): 홍보성, 영향 없음
`;

// ============================================
// 감성 분석 Rubric
// ============================================

export const SENTIMENT_RUBRIC = `
## 감성(Sentiment) 분석 기준

### 감성 분류

| 감성 | 정의 | 시장 영향 |
|------|------|----------|
| **positive** | 경제/시장에 긍정적 신호 | 주가 상승, 소비 증가, 고용 개선 기대 |
| **negative** | 경제/시장에 부정적 신호 | 주가 하락, 소비 위축, 불확실성 증가 |
| **neutral** | 뚜렷한 방향성 없음 | 정보 제공 목적, 시장 영향 제한적 |
| **mixed** | 긍정/부정 요소 혼재 | 해석에 따라 다른 반응 가능 |

### 신뢰도(Confidence) 기준

| 신뢰도 | 상황 |
|--------|------|
| **0.9-1.0** | 기사가 명확히 긍정/부정 표현 (예: "사상 최대 실적", "파산 신청") |
| **0.7-0.9** | 맥락상 방향성이 분명함 (예: 금리 인상 → 부정적) |
| **0.5-0.7** | 해석의 여지가 있음 (예: M&A → 시너지 vs 부채 증가) |
| **0.3-0.5** | 방향성이 불분명하거나 혼재 |
| **0.0-0.3** | 정보 부족으로 판단 어려움 |

### 주의사항

- 기사 톤이 아닌 **실제 경제적 영향**을 기준으로 판단
- 단기 vs 장기 영향이 다를 경우 **중기(1-3개월) 영향** 기준
- 주어진 정보만으로 판단, 외부 지식 과도하게 활용 지양
`;

// ============================================
// 카테고리 분류 Rubric
// ============================================

export const CATEGORY_RUBRIC = `
## 카테고리 분류 기준

| 카테고리 | 정의 | 예시 키워드 |
|----------|------|-------------|
| **economy** | 거시경제 지표, 경제 전망 | GDP, 인플레이션, 실업률, 경기, 성장률 |
| **finance** | 금융기관, 금리, 통화정책 | 은행, 금리, 연준, 한은, 대출, 예금 |
| **business** | 기업 활동, 실적, 경영 | 실적, 매출, 영업이익, CEO, M&A, 신제품 |
| **markets** | 주식/채권/원자재 시장 | 코스피, S&P500, 주가, 채권, 금값, 유가 |
| **policy** | 정부 정책, 규제 | 규제, 법안, 정책, 세금, 관세 |
| **trade** | 국제무역, 수출입 | 수출, 수입, 무역협정, 관세, 공급망 |

### 분류 우선순위

하나의 기사가 여러 카테고리에 해당할 경우:
1. **핵심 주제**가 무엇인지 파악
2. **시장 영향**의 주된 경로 고려
3. 애매한 경우 더 넓은 범위의 카테고리 선택

예시:
- "연준 금리 결정" → **policy** (통화정책이 핵심)
- "삼성전자 실적 발표" → **business** (기업 실적이 핵심)
- "코스피 2,500 돌파" → **markets** (시장 동향이 핵심)
`;

// ============================================
// 시간 지평(Time Horizon) Rubric
// ============================================

export const TIME_HORIZON_RUBRIC = `
## 시간 지평(Time Horizon) 기준

영향이 **가장 크게 나타나는 시점**을 기준으로 판단합니다.

| 구분 | 기간 | 예시 |
|------|------|------|
| **short** | 1주일 이내 | 실적 발표 직후 주가 반응, 금리 결정 당일 시장 반응 |
| **medium** | 1주~3개월 | 정책 효과 반영, 실적 가이던스 반영, 계절적 요인 |
| **long** | 3개월 이상 | 구조적 변화, 장기 트렌드, 인구/기후 변화 영향 |

### 판단 기준

1. **즉각 반응 vs 점진 반영**: 시장이 바로 반응하나, 시간 걸려 반영되나?
2. **일회성 vs 지속성**: 이벤트가 끝나면 영향도 끝나나, 지속되나?
3. **불확실성 해소 시점**: 언제 결과가 명확해지나?
`;

// ============================================
// 전체 Rubric 결합
// ============================================

export const FULL_ANALYSIS_RUBRIC = `
${IMPORTANCE_RUBRIC}

---

${SENTIMENT_RUBRIC}

---

${CATEGORY_RUBRIC}

---

${TIME_HORIZON_RUBRIC}
`;

/**
 * 특정 필드에 대한 Rubric만 반환
 */
export function getRubricForField(
  field: "importance" | "sentiment" | "category" | "timeHorizon"
): string {
  switch (field) {
    case "importance":
      return IMPORTANCE_RUBRIC;
    case "sentiment":
      return SENTIMENT_RUBRIC;
    case "category":
      return CATEGORY_RUBRIC;
    case "timeHorizon":
      return TIME_HORIZON_RUBRIC;
    default:
      return FULL_ANALYSIS_RUBRIC;
  }
}
