/**
 * Few-shot 예시 - AI 분석 품질 향상을 위한 고품질 예시
 *
 * 카테고리별로 좋은 분석 예시를 제공하여 AI가 형식과 깊이를 학습하도록 함
 */

import type { NewsAnalysisResult } from "@/schemas/news-analysis.ts";

// ============================================
// 예시 타입 정의
// ============================================

export interface AnalysisExample {
  category: string;
  input: {
    title: string;
    description: string;
    source: string;
    region: "US" | "KR";
  };
  output: NewsAnalysisResult;
  reasoning: string; // 왜 이렇게 분석했는지 설명
}

// ============================================
// 정책/금리 관련 예시 (Policy)
// ============================================

export const POLICY_EXAMPLE: AnalysisExample = {
  category: "policy",
  input: {
    title: "Fed Raises Interest Rates by 0.25%, Signals More Hikes Ahead",
    description:
      "The Federal Reserve raised its benchmark interest rate by 25 basis points to a range of 5.25%-5.5%, the highest level in 22 years. Chair Powell indicated that further rate increases may be necessary to bring inflation down to the 2% target.",
    source: "CNBC",
    region: "US",
  },
  output: {
    headline_summary:
      "미국 연준이 또 금리를 올렸어요. 이번에 0.25%p를 올려서 22년 만에 가장 높은 수준인 5.25~5.5%가 됐습니다. 파월 의장은 물가를 잡기 위해 앞으로 더 올릴 수도 있다는 신호를 보냈어요. 대출 이자가 계속 오를 수 있으니 미리 준비하시는 게 좋겠습니다.",
    so_what: {
      main_point:
        "미국 중앙은행의 금리 결정은 전 세계 금융시장의 '기준점' 역할을 해요. 마치 선생님이 시험 난이도를 올리면 모든 학생이 영향받는 것처럼, 미국 금리가 오르면 전 세계 돈의 흐름이 바뀝니다. 특히 우리나라처럼 외국 투자가 많은 나라는 자본이 빠져나갈 수 있고, 원/달러 환율에도 영향을 줘요. 집을 사려고 대출을 고민하시는 분들, 주식 투자를 하시는 분들 모두 주의 깊게 지켜봐야 할 소식이에요.",
      market_signal:
        "전반적으로 부정적인 신호예요. 금리가 높으면 기업들이 돈 빌리기 어려워져서 투자를 줄이고, 주식 가치도 떨어지는 경향이 있어요. 특히 테슬라나 엔비디아 같은 성장주는 타격이 클 수 있어요. 다만 은행들은 이자 수입이 늘어나서 오히려 수혜를 볼 수 있답니다.",
      time_horizon: "medium",
    },
    impact_analysis: {
      investors: {
        summary:
          "주식시장이 출렁일 수 있어요. 특히 성장주(테슬라, 엔비디아 같은 기술주)는 금리에 민감해서 조심하셔야 해요. 반면 은행주나 단기 채권은 괜찮은 피난처가 될 수 있습니다. 달러가 강해지니까 해외 주식이나 ETF에 투자하시는 분들은 환율도 꼭 체크해보세요.",
        action_items: [
          "성장주 비중이 많다면 일부 현금화를 고려해보세요",
          "단기 채권 ETF(예: SHY)로 안전하게 이자 받는 것도 좋은 방법이에요",
          "달러 예금 금리가 높아졌으니 분산 투자 차원에서 고려해보셔도 좋아요",
        ],
        sectors_affected: [
          "은행 (수혜 - 이자 수입이 늘어나요)",
          "부동산 (타격 - 대출 비용이 올라요)",
          "기술주 (타격 - 미래 수익 가치가 떨어져요)",
          "유틸리티 (타격 - 배당주라 금리에 민감해요)",
        ],
      },
      workers: {
        summary:
          "당장 큰 변화는 없겠지만, 금리가 높은 상태가 오래 가면 회사들이 허리띠를 조이기 시작해요. 특히 부동산, 건설업계나 스타트업 쪽은 채용이 줄어들 수 있어요. 반면 은행이나 금융권, IT 보안 같은 필수 분야는 여전히 사람을 뽑을 거예요.",
        industries_affected: [
          "부동산/건설 (채용 축소 예상)",
          "스타트업/벤처 (투자 위축으로 어려움)",
          "소매유통 (소비 둔화 영향)",
          "금융/은행 (상대적으로 안정)",
        ],
        job_outlook:
          "신규 채용은 조금 보수적으로 바뀔 수 있어요. 하지만 경력직이나 AI, 데이터 분석 같은 전문 기술을 가진 분들 수요는 여전해요. 이직을 고민하신다면 회사 재무상태를 꼼꼼히 확인해보시는 게 좋겠어요.",
      },
      consumers: {
        summary:
          "대출 이자가 오르니까 주담대(주택담보대출)나 신용대출 있으신 분들은 부담이 커져요. 쉽게 말해 '돈 빌리는 비용'이 올라가는 거예요. 반면 예금 이자도 같이 올라서 저축하시는 분들에게는 좋은 소식이기도 해요. 적금이나 예금 금리 비교해보시면 괜찮은 상품들이 있을 거예요.",
        price_impact:
          "대출 이자 부담은 늘어나고, 집값은 좀 주춤할 수 있어요. 예금 이자가 오른 건 그나마 위안이 되는 부분이에요.",
        spending_advice:
          "변동금리 대출이 있다면 고정금리로 바꿀지 은행에 상담받아보세요. 큰 구매(자동차, 가전 등)는 현금 비중을 높이거나 조금 미루는 것도 방법이에요. 고금리 적금 상품도 찾아보시면 좋겠어요.",
      },
    },
    related_context: {
      background:
        "연준은 작년부터 계속 금리를 올려왔어요. 코로나 때 경기 살리려고 돈을 많이 풀었더니 물가가 너무 올라버린 거예요. '40년 만에 최악의 인플레이션'이라는 말이 나올 정도였죠. 이번이 벌써 11번째 인상인데, 그만큼 물가 잡기가 쉽지 않다는 뜻이에요.",
      related_events: [
        "올해 초 실리콘밸리은행(SVB) 파산 - 금리 인상의 부작용을 보여준 사례예요",
        "유럽도 금리 올리는 중 - 전 세계적인 현상이에요",
        "일본만 예외로 초저금리 유지 중 - 엔화 약세의 원인이에요",
      ],
      what_to_watch:
        "다음 달 FOMC(연방공개시장위원회) 회의가 중요해요. 물가가 얼마나 잡히느냐에 따라 금리 동결 가능성도 있어요. 8월 고용지표랑 물가지수(CPI)가 나오면 방향이 더 명확해질 거예요. 뉴스 챙겨보시면 좋겠습니다.",
    },
    keywords: ["연준", "금리인상", "인플레이션", "파월", "FOMC", "달러"],
    category: "policy",
    sentiment: {
      overall: "negative",
      confidence: 0.85,
    },
    importance_score: 9,
  },
  reasoning:
    "미국 중앙은행의 금리 결정은 전 세계 금융시장에 직접적인 영향을 미치는 시스템적 이벤트예요. 모든 자산(주식, 채권, 부동산, 환율)에 영향을 주고, 투자자/직장인/소비자 모두에게 실질적 영향이 있어서 9점을 부여했어요.",
};;

// ============================================
// 기업 실적 관련 예시 (Earnings)
// ============================================

export const EARNINGS_EXAMPLE: AnalysisExample = {
  category: "earnings",
  input: {
    title: "삼성전자, 2분기 영업이익 96% 급감…반도체 업황 악화",
    description:
      "삼성전자가 2분기 영업이익 6,700억원을 기록하며 전년 동기 대비 96% 급감했다. 메모리 반도체 가격 하락과 재고 조정이 주요 원인으로, 회사는 하반기 점진적 회복을 전망했다.",
    source: "매일경제",
    region: "KR",
  },
  output: {
    headline_summary:
      "삼성전자 2분기 실적이 정말 많이 떨어졌어요. 영업이익이 6,700억원으로 작년 같은 때보다 무려 96%나 줄었습니다. 반도체 가격이 많이 내려간 게 주요 원인인데요, 회사에서는 하반기부터 조금씩 나아질 거라고 전망하고 있어요. 반도체 업계의 어려운 시기를 보여주는 뉴스예요.",
    so_what: {
      main_point:
        "삼성전자는 코스피 시가총액의 약 20%를 차지하는 한국 증시의 '대장주'예요. 마치 학교에서 제일 잘하는 학생 성적이 떨어지면 전체 평균에 영향을 주는 것처럼, 삼성전자 실적이 나쁘면 코스피 전체가 흔들릴 수 있어요. 하지만 좋은 소식도 있어요. 실적이 이렇게 나빴다는 건 오히려 '바닥을 쳤다'는 신호일 수 있거든요. 주가는 미래를 미리 반영하니까, 이미 나쁜 소식을 어느 정도 반영했을 가능성이 있어요.",
      market_signal:
        "복잡한 신호예요. 숫자만 보면 부정적이지만, '이제 바닥이구나' 하고 반등을 기대하는 투자자들도 있어요. 특히 AI 붐으로 고성능 메모리(HBM) 수요가 늘고 있어서, 하반기에는 좀 나아질 거라는 기대도 있습니다.",
      time_horizon: "medium",
    },
    impact_analysis: {
      investors: {
        summary:
          "반도체 주식에 투자하시는 분들은 '지금이 살 때인가?' 고민이 되실 거예요. 삼성전자뿐 아니라 SK하이닉스, 반도체 장비주들도 비슷한 상황이에요. 한꺼번에 사기보다는 나눠서 조금씩 사는 '분할 매수' 전략을 고려해보시는 게 좋겠어요. AI 관련 반도체는 수요가 좋으니 그쪽도 눈여겨보세요.",
        action_items: [
          "한 번에 많이 사지 말고, 나눠서 조금씩 분할 매수를 고려해보세요",
          "AI 수혜를 받을 수 있는 HBM 관련 종목도 함께 살펴보세요",
          "반도체 사이클이 진짜 바닥인지 3분기 실적까지 지켜보는 것도 방법이에요",
        ],
        sectors_affected: [
          "삼성전자, SK하이닉스 (직접 영향)",
          "반도체 장비주 - 한미반도체, 주성엔지니어링 (간접 영향)",
          "삼성SDI, LG에너지솔루션 등 2차전지도 참고해보세요",
        ],
      },
      workers: {
        summary:
          "삼성전자 다니시는 분들, 협력사에서 일하시는 분들 걱정되시죠? 다행히 대규모 구조조정보다는 신규 투자를 미루는 정도로 대응할 것 같아요. 다만 신규 채용은 조금 줄어들 수 있어요. 반면 AI 반도체나 HBM 같은 차세대 기술 분야는 여전히 인력을 찾고 있으니, 관련 역량을 키워두시면 좋겠어요.",
        industries_affected: [
          "반도체 제조 (직접 영향, 채용 축소 가능)",
          "반도체 장비/소재 (간접 영향)",
          "IT 서비스 (일부 프로젝트 축소 가능)",
        ],
        job_outlook:
          "당장 큰 감원은 없을 것 같지만, 신규 채용은 보수적으로 바뀔 수 있어요. 이직을 준비하신다면 AI, 클라우드, 보안 같은 성장 분야를 고려해보시는 것도 좋겠어요. HBM 같은 차세대 메모리 기술 인력은 여전히 귀해요.",
      },
      consumers: {
        summary:
          "의외로 소비자분들에게는 좋은 소식이에요! 메모리 가격이 떨어졌다는 건 PC나 스마트폰 가격이 안정되거나 내려갈 수 있다는 뜻이거든요. 노트북이나 폰 바꾸실 계획이 있으시다면 조금 기다려보셔도 좋아요. 다만 삼성전자 주식을 갖고 계신 분들은 배당금이 줄어들 수 있다는 점은 참고하세요.",
        price_impact:
          "전자제품 가격에는 긍정적이에요. 메모리 가격이 내려간 만큼 PC, 노트북, 스마트폰 가격도 안정될 거예요.",
        spending_advice:
          "새 PC나 스마트폰을 사시려고 하셨다면 서두르지 않아도 돼요. 가격이 크게 오르지는 않을 것 같아요. 쿠팡, 11번가 등에서 프로모션도 많이 할 테니 비교해보시고 사세요.",
      },
    },
    related_context: {
      background:
        "반도체 업계는 호황과 불황이 반복되는 '사이클' 산업이에요. 2022년 하반기부터 불황이 시작됐는데, 코로나 때 컴퓨터랑 스마트폰이 엄청 많이 팔렸거든요. 그래서 재고가 쌓이고 가격이 50% 넘게 떨어졌어요. 지금은 그 안 좋은 시기의 끝자락이라고 보는 시각이 많아요.",
      related_events: [
        "SK하이닉스도 큰 적자를 냈어요 - 업계 전체가 힘든 상황이에요",
        "미국 마이크론도 실적이 안 좋아서 생산량을 줄이기로 했어요",
        "엔비디아 AI 반도체가 대박 나면서 고성능 메모리(HBM) 수요가 폭발하고 있어요",
      ],
      what_to_watch:
        "3분기 실적이 중요해요. 거기서 회복 조짐이 보이면 '진짜 바닥을 찍었구나' 확인할 수 있어요. 특히 AI 서버용 HBM 매출이 얼마나 늘었는지, 메모리 가격이 반등하는지 뉴스 챙겨보시면 좋겠어요.",
    },
    keywords: [
      "삼성전자",
      "반도체",
      "영업이익",
      "메모리",
      "실적",
      "HBM",
      "AI",
    ],
    category: "business",
    sentiment: {
      overall: "mixed",
      confidence: 0.75,
    },
    importance_score: 8,
  },
  reasoning:
    "삼성전자는 한국 최대 기업이고 글로벌 반도체 시장에서도 핵심적인 회사예요. 실적이 많이 나빠진 건 한국 증시 전체와 반도체 관련 회사들에 영향을 주지만, 시장이 어느 정도 예상했던 부분도 있어서 8점을 줬어요.",
};;

// ============================================
// 거시경제 지표 예시 (Macro)
// ============================================

export const MACRO_EXAMPLE: AnalysisExample = {
  category: "macro",
  input: {
    title: "US Inflation Falls to 3% in June, Lowest in Over Two Years",
    description:
      "Consumer prices rose 3% in June from a year ago, down from 4% in May and well below the 9.1% peak in June 2022. Core inflation, which excludes food and energy, came in at 4.8%, also lower than expected.",
    source: "Yahoo Finance",
    region: "US",
  },
  output: {
    headline_summary:
      "드디어 좋은 소식이에요! 미국 6월 물가 상승률이 3%로 내려왔어요. 작년 6월에는 9.1%까지 치솟았었는데, 2년 만에 가장 낮은 수준이에요. 물가가 잡히고 있다는 확실한 신호입니다. 식료품이랑 에너지를 빼고 계산하는 '근원 물가'도 4.8%로 예상보다 낮게 나왔어요.",
    so_what: {
      main_point:
        "물가가 안정되고 있다는 건 연준(미국 중앙은행)이 더 이상 금리를 올리지 않을 수도 있다는 뜻이에요. 마치 열이 내려가면 해열제를 더 먹을 필요가 없는 것처럼요. 이건 주식시장에 아주 좋은 소식이에요. 특히 그동안 금리 때문에 힘들었던 기술주나 성장주, 부동산 관련 종목들이 숨통이 트일 수 있어요. 다만 근원 물가가 아직 2%(연준 목표)보다 높아서, 당장 금리를 내리기는 이를 것 같아요.",
      market_signal:
        "긍정적인 신호예요! 물가가 고점을 찍고 내려오는 '피크아웃'이 확인됐어요. 이제 시장은 '금리를 더 올릴까?' 걱정보다 '언제 내릴까?' 기대를 하기 시작할 거예요. 주식이나 위험자산에 돈이 다시 들어올 수 있어요.",
      time_horizon: "short",
    },
    impact_analysis: {
      investors: {
        summary:
          "주식 투자하시는 분들에게 반가운 뉴스예요! 금리 인상 걱정이 줄어들면 주식시장이 좋아지거든요. 특히 그동안 많이 떨어졌던 기술주나 성장주가 반등할 수 있어요. 채권 가격도 오를 수 있고요(금리가 내리면 채권 가격은 올라요). 조금씩 공격적인 투자를 늘려볼 타이밍일 수 있어요.",
        action_items: [
          "그동안 미뤄뒀던 성장주 투자를 조금씩 시작해보시는 건 어떨까요?",
          "장기 채권 ETF도 좋은 선택이 될 수 있어요",
          "금이나 원자재 비중은 조금 줄여도 괜찮을 것 같아요",
        ],
        sectors_affected: [
          "기술주 (수혜 - 애플, 마이크로소프트 등)",
          "성장주 (수혜 - 금리 부담 완화)",
          "부동산/리츠 (수혜 - 대출 비용 안정)",
          "금/원자재 (중립 - 인플레이션 헤지 필요성 감소)",
        ],
      },
      workers: {
        summary:
          "직장인분들에게도 좋은 소식이에요. 물가가 안정되면 월급의 실질 가치가 늘어나는 효과가 있어요. 같은 월급으로 살 수 있는 게 많아진다는 뜻이죠. 마트나 편의점 가서 장볼 때 부담이 조금 줄어들 거예요. 경기가 너무 확 꺾이지 않으면 고용시장도 안정적으로 유지될 것 같아요.",
        industries_affected: [
          "전 산업이 긍정적인 영향을 받아요",
          "특히 소매, 외식업 - 소비가 살아날 수 있어요",
          "여행, 레저 - 가계 부담 줄어들면 지출 늘어날 수 있어요",
        ],
        job_outlook:
          "경기가 '연착륙'(크게 안 좋아지지 않고 안정되는 것)할 가능성이 높아졌어요. 그러면 대량 해고 같은 무서운 일은 없을 거예요. 다만 금리가 아직 높은 편이라 채용이 확 늘지는 않을 것 같아요. 천천히 좋아지는 흐름이라고 보시면 돼요.",
      },
      consumers: {
        summary:
          "소비자분들, 장보실 때 조금 숨통이 트일 거예요! 물가 상승세가 꺾이고 있어서 식료품이나 생필품 가격이 안정될 전망이에요. 특히 에너지(기름값, 전기료) 부담도 줄어들고 있어요. 다만 집세나 서비스 가격(외식, 미용 등)은 아직 높은 편이에요.",
        price_impact:
          "전반적으로 물가 오르는 속도가 느려지고 있어요. 당장 가격이 내려가지는 않지만, 더 오르지 않는 것만으로도 다행이에요. 휘발유값은 많이 안정됐고, 마트 물가도 조금씩 나아지고 있어요.",
        spending_advice:
          "지금 당장 급하지 않은 큰 지출(자동차, 가전제품 등)은 조금 더 기다려보셔도 좋아요. 예금 이자가 아직 높으니까 저축해두시면 이자도 쏠쏠하게 받을 수 있어요. 고금리 적금 가입하시기 좋은 시기예요.",
      },
    },
    related_context: {
      background:
        "코로나 이후 전 세계적으로 물가가 미친 듯이 올랐어요. 미국은 40년 만에 가장 높은 물가 상승률을 기록했죠. 공장에서 물건이 안 나오는데(공급망 문제) 사람들은 돈을 많이 받아서(정부 지원금) 물건을 사려고 했거든요. 연준이 금리를 빠르게 올려서 이제 겨우 물가가 잡히기 시작한 거예요.",
      related_events: [
        "기름값이 배럴당 70달러대로 안정됐어요 - 작년에 120달러 넘었었죠",
        "중국에서 물건 배송이 정상화되면서 공산품 가격이 내려오고 있어요",
        "일자리 시장 열기가 조금 식고 있어요 - 이것도 물가 안정에 도움이 돼요",
      ],
      what_to_watch:
        "이번 달 연준(FOMC) 회의에서 마지막으로 0.25%p 올리고 끝낼 수도 있어요. 앞으로 나올 물가 지표랑 고용 지표가 중요해요. 물가가 계속 내려오면 내년에는 금리 인하 얘기도 나올 수 있어요. 뉴스 잘 챙겨보세요!",
    },
    keywords: ["인플레이션", "CPI", "물가", "연준", "금리", "경기연착륙"],
    category: "economy",
    sentiment: {
      overall: "positive",
      confidence: 0.8,
    },
    importance_score: 9,
  },
  reasoning:
    "미국 물가지수(CPI)는 연준 정책의 핵심 지표예요. 물가가 안정되면 금리 정책이 바뀔 수 있고, 그러면 전 세계 주식, 채권, 부동산 모든 자산에 영향을 줘요. 아주 중요한 뉴스라서 9점을 줬어요.",
};;

// ============================================
// 모든 예시 모음
// ============================================

export const ANALYSIS_EXAMPLES: AnalysisExample[] = [
  POLICY_EXAMPLE,
  EARNINGS_EXAMPLE,
  MACRO_EXAMPLE,
];

/**
 * 카테고리에 맞는 예시 반환
 */
export function getExampleByCategory(
  category: string
): AnalysisExample | undefined {
  return ANALYSIS_EXAMPLES.find((ex) => ex.category === category);
}

/**
 * 지역에 맞는 예시 반환
 */
export function getExamplesByRegion(region: "US" | "KR"): AnalysisExample[] {
  return ANALYSIS_EXAMPLES.filter((ex) => ex.input.region === region);
}

/**
 * 프롬프트용 예시 포맷팅
 */
export function formatExampleForPrompt(example: AnalysisExample): string {
  return `
### 예시: ${example.input.title}

**입력 정보:**
- 제목: ${example.input.title}
- 설명: ${example.input.description}
- 출처: ${example.input.source}

**분석 결과:**
\`\`\`json
${JSON.stringify(example.output, null, 2)}
\`\`\`

**분석 근거:** ${example.reasoning}
`;
}
